
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.1.3">
    
    
      
        <title>Ontwerpen - Portfolio</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.e35208c4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ef6f36e2.min.css">
        
          
          
          <meta name="theme-color" content="#7e56c2">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="deep-purple" data-md-color-accent="">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#model-experimenten-versie-1" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Portfolio" class="md-header__button md-logo" aria-label="Portfolio" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Portfolio
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Ontwerpen
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Portfolio" class="md-nav__button md-logo" aria-label="Portfolio" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Portfolio
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Leeswijzer
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../analyseren/" class="md-nav__link">
        Analyseren
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Ontwerpen
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Ontwerpen
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#model-experimenten-versie-1" class="md-nav__link">
    Model experimenten versie 1
  </a>
  
    <nav class="md-nav" aria-label="Model experimenten versie 1">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#beschrijving-resultaten" class="md-nav__link">
    Beschrijving &amp; resultaten
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bevindingen" class="md-nav__link">
    Bevindingen
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#architectuur" class="md-nav__link">
    Architectuur
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-experimenten-versie-2" class="md-nav__link">
    Model experimenten versie 2
  </a>
  
    <nav class="md-nav" aria-label="Model experimenten versie 2">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gegevensverzameling" class="md-nav__link">
    Gegevensverzameling
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#beschrijving-resultaten_1" class="md-nav__link">
    Beschrijving &amp; resultaten
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bevindingen_1" class="md-nav__link">
    Bevindingen
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../realiseren/" class="md-nav__link">
        Realiseren
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../adviseren/" class="md-nav__link">
        Adviseren
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../beheer/" class="md-nav__link">
        Beheer
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../planning/" class="md-nav__link">
        Planning
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../blog/" class="md-nav__link">
        Blog
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#model-experimenten-versie-1" class="md-nav__link">
    Model experimenten versie 1
  </a>
  
    <nav class="md-nav" aria-label="Model experimenten versie 1">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#beschrijving-resultaten" class="md-nav__link">
    Beschrijving &amp; resultaten
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bevindingen" class="md-nav__link">
    Bevindingen
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#architectuur" class="md-nav__link">
    Architectuur
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-experimenten-versie-2" class="md-nav__link">
    Model experimenten versie 2
  </a>
  
    <nav class="md-nav" aria-label="Model experimenten versie 2">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gegevensverzameling" class="md-nav__link">
    Gegevensverzameling
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#beschrijving-resultaten_1" class="md-nav__link">
    Beschrijving &amp; resultaten
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bevindingen_1" class="md-nav__link">
    Bevindingen
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Ontwerpen</h1>
                
                <h2 id="model-experimenten-versie-1">Model experimenten versie 1</h2>
<p>Voor de uitbreiding van het Twindle project zullen machine learning modellen gebruikt worden om de luchtkwaliteit te voorspellen. Dit zullen modellen zijn voor luchtvochtigheid, temperatuur, CO2 en TVOC. Deze modellen moeten voldoen aan bepaalde eisen, welke besproken worden in het <a href="../analyseren/#machine-learning-requirements">analyseren: requirements - machine learning</a> onderdeel.</p>
<h3 id="beschrijving-resultaten">Beschrijving &amp; resultaten</h3>
<p>Om een betere indicatie te krijgen wat voor soort modellen toegepast kunnen worden is extra data exploratie verricht<sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup>. Hieruit is gebeleken dat de data seizoensgebonden- en niet stationair is. Dit betekend dat standaard least-squares regressie niet toegepast kan worden, dit namelijk leiden tot sterke overfitting.</p>
<p>Na onderzoek<sup id="fnref:2"><a class="footnote-ref" href="#fn:2">2</a></sup> te hebben gedaan naar modellering technieken voor dit soort data is besloten om met de volgende modellen te experimenteren:</p>
<ul>
<li>Lineare Regressie</li>
<li>Exponential Smoothing</li>
<li>Autoregressive Integrated Moving Average</li>
</ul>
<p><strong>Lineaire Regressie</strong> <br>
Om lineare regressie toe te kunnen passen moet de data geen autocorrelaties bevatten en stationair zijn. Hiervoor zijn differencing, het verschil tussen een meting en de voorgaande meting, technieken toegepast. Daarnaast is er een techniek<sup id="fnref:3"><a class="footnote-ref" href="#fn:3">3</a></sup> gebruikt om de opeenvolgende data voor te bereiden voor gebruik in de algoritmen.</p>
<p>De volgende modellen zijn toegepast:</p>
<ul>
<li><a href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html">LinearRegression</a> (LR)</li>
<li><a href="https://scikit-learn.org/stable/modules/generated/sklearn.neighbors.KNeighborsRegressor.html">KNearestNeigbors</a> (KNN)</li>
<li><a href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestRegressor.html">RandomForestRegressor</a> (RF)</li>
</ul>
<p><img alt="Gemiddelde R-squared per meetwaarde en model" src="../images/linear-regression-results.png" /></p>
<p><center><small>Afbeelding 1: Gemiddelde R-squared per meetwaarde en model</small></center></p>
<p>Aan de bovenstaande afbeeldingen is het volgende af te leiden:</p>
<ul>
<li>Geen enkel linear regressie model behaalt de eis van 0.9 r-squared.</li>
<li>De lage of negatieve r-squared scores betekenen dat er geen patronen gevonden zijn.</li>
</ul>
<p>Waarschijnlijk missen er nog cruciale features. In verder iteraties zal dit verder onderzocht worden.</p>
<p><strong>Exponential Smoothing</strong> <br>
Voorspelling die gemaakt worden met exponential smoothing methoden zijn gemiddelden van eerdere waarnemingen, waarbij de eerdere waarnemingen zwaarder meewegen dan de ouderen.</p>
<p>De Holt-Winters seasonal methode is gebruikt om te kunnen profiteren van de trends en seizoensgebondenheid die aanwezig zijn in de data. Het <code>statsmodel</code> package heeft hier de volgende implementatie van:</p>
<ul>
<li><a href="https://www.statsmodels.org/dev/generated/statsmodels.tsa.holtwinters.ExponentialSmoothing.html">ExponentialSmoothing</a></li>
</ul>
<p><img alt="Exponential smoothing per meetwaarde" src="../images/exponential-smooting.png" /></p>
<p><center><small>Afbeelding 2: Exponential Smoothing resultaten per meetwaarde</small></center></p>
<p>Dit soort modellen lijken op het begin de trend goed te volgen. Na ongeveer een of twee uur beginnen ze echter steeds minder accuraat te worden en overschieten ze vaak het doel. Voor meetwaarden die afhankelijk zijn van andere factoren, zoals luchtvochtigheid en temperatuur, zijn deze modellen minder accuraat.</p>
<p><strong>Autoregressive Integrated Moving Average</strong> <br>
Autoregressive integrated moving average (ARIMA) modellen maken gebruik van een combinatie van de volgende technieken.</p>
<ul>
<li>Autoregression (AR)</li>
<li>Moving average (MA)</li>
</ul>
<p>Het kan gebruik maken van de trends, autocorrelatie en seizoensgebondenheid van de data. In dit geval is er gekozen voor de <code>auto_arima</code> methode van het <code>PMDARIMA</code> package. Hierbij worden meerdere combinaties van het model uitgetests en uiteindelijk het hoogst scorende model opgeslagen.</p>
<p><img alt="ARIMA resultaten per meetwaarden" src="../images/arima.png" /></p>
<p>Net als bij de Exponential Smoothing modellen presteert deze techniek beter op de TVOC en CO2 meetwaarden. Deze waarden hebben ook een wekelijkse seizoensgebondenheid die momenteel nog niet gemodelleerd is. Wanneer er meer data beschikbaar is zal dit meegenomen worden in het model wat waarschijnlijk resulteert in hogere scores.</p>
<h3 id="bevindingen">Bevindingen</h3>
<p>Momenteel is er nog geen enkel model wat de gestelde eis van 0.9 r-squared score behaalt. Wel komen de ARIMA modellen redelijk dicht in de buurt. Met deze reden is er voor gekozen om de eerste iteratie van de implementatie deze modellen toe te passen.</p>
<h2 id="architectuur">Architectuur</h2>
<p>Ongeveer 90% van de data science projecten haalt het niet tot productie<sup id="fnref:4"><a class="footnote-ref" href="#fn:4">4</a></sup>. Dit komt doordat het proces wat gebruikt wordt om machine learning modellen te ontwikkelen net perse goed aansluit bij de software engineering &amp; DevOps processen. Om dit te voorkomen bij het Digital Twin 3.0 project zal hier rekening mee gehouden worden tijdens het ontwerp.</p>
<p>Tijdens het ontwerp is er gewerkt met de C4 methoden<sup id="fnref:5"><a class="footnote-ref" href="#fn:5">5</a></sup>. Dit is een ontwerp framework wat op vier abstractieniveaus de applicatie toelicht.</p>
<ol>
<li>Context; Op hoog niveau wordt weergegeven wie er op welke manier interacteert met de systemen.</li>
<li>Container; Globaal overzicht van de software architectuur. Focus op technologiekeuze en manier van communicatie.</li>
<li>Component; Overzicht van welke onderdelen samen de container vormen.</li>
<li>Code; Laag niveau overzicht van de code door, bijvoorbeeld, klasse diagrammen.</li>
</ol>
<p><strong>Vooronderzoek</strong> <br>
Voor dat een begin gemaakt was met het ontwerpen van de applicatie is eerst vooronderzoek<sup id="fnref:6"><a class="footnote-ref" href="#fn:6">6</a></sup> verricht om te bepalen welke tools en technieken toegepast gingen worden. Dit vooronderzoek ging dieper in op de volgende onderwerpen:</p>
<ol>
<li>Het opslaan en ophalen van de data en voorspellingen.</li>
<li>Frameworks en tooling die hierbij passen.</li>
<li>API; gekozen voor <code>Flask</code></li>
<li>Database; gekozen voor <code>MySQL</code></li>
<li>Hoe feedback verzameld wordt en iteratief verwerkt kan worden.</li>
<li>Modellen periodiek trainen en evalueren (R<sup>2</sup> &amp; RMSE)</li>
</ol>
<p><strong>C1: Context</strong> <br>
In het onderstaande systeem context diagram zijn de gebruikersgroepen en de manier waarop zij de applicatiegebruiken gevisualiseerd.</p>
<p><img alt="Systeem context diagram" src="../images/ontwerp/c1_context.png" /></p>
<p><center><small>Afbeelding 3: Systeem context diagram</small></center></p>
<p><strong>C2: Containers</strong><br>
In dit diagram zal er verder ingezoomt worden op de twee software systemen zoals deze zijn beschreven in het vorige diagram. Ze zijn verder onderverdeeld worden in containers. Containers zijn onderdelen van het systeem die apart van elkaar functioneren. In dit diagram ligt de focus op de technologie keuzes en manier van communicatie tussen containers.</p>
<p><img alt="Container diagram" src="../images/ontwerp/c2_container.png" /></p>
<p><center><small>Afbeelding 4: Container diagram</small></center></p>
<p>De webapplicatie haalt voorspellingen op uit de AI-layer. Om deze voorspellingen te kunnen maken is historische data nodig die voorzien wordt door de back-end applicatie van de Digital Twin.</p>
<p><strong>C3: Components</strong> <br>
Iedere container uit het vorige diagram bestaat uit een of meerdere componenten. In dit diagram zal de technologiekeuze, communicatie en verantwoordelijkheden van deze componenten worden toegelicht.</p>
<p><img alt="Systeem context diagram" src="../images/ontwerp/c3_components_ai_layer.png" /></p>
<p><center><small>Afbeelding 5: Components diagram</small></center></p>
<p><strong>C4: Code</strong> <br>
Onderstaand valt een overzicht te vinden van de routes die aan de API zijn toegevoegd. Via deze route kunnen de voorspellingen die gemaakt zijn opgevraagd worden door het front-end</p>
<table>
<thead>
<tr>
<th align="right">Methode</th>
<th>Route</th>
<th>Parameters</th>
<th>Type</th>
<th>Response</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">GET</td>
<td>/forecasts/:location/:room/:metric</td>
<td></td>
<td></td>
<td>[ { "timestamp": date, "value": float } .... ]</td>
</tr>
</tbody>
</table>
<p>In de applicatie zullen zich meerdere entiteiten bevinden. Onderstaand is een overzicht van deze entiteiten en hun attributen en relaties te zien.</p>
<p><center>
<img alt="Entity Relation diagram" height="70%" src="../images/ontwerp/erd.png" width="70%" />
</center>
<center><small>Afbeelding 6: Entity relation diagram</small></center></p>
<h2 id="model-experimenten-versie-2">Model experimenten versie 2</h2>
<p>De voorgaande experimenten resulteerde nog niet in modellen die de eis van 0.9 r-squared haalde. Uiteindelijk is toch besloten om deze modellen toe te passen in de applicatie. Uit deze <a href="../realiseren/#oplevering-2-integratie-arima-modellen">implementatie</a> bleek dat de modellen niet presteerde zoals verwacht. Om het doel te behalen moeten de volgende aanpassingen gedaan worden:</p>
<ol>
<li>Onderzoeken wat invloed heeft op de veranderingen in de meetwaarden.</li>
<li>Verder in de toekomst kijken</li>
<li>Betere controle voor welk tijdstip de voorspelling wordt gemaakt.</li>
<li>Bestandsgrootte limiteren om schaalbaarheid te vergroten</li>
</ol>
<p>In overleg met de opdrachtgevers en belangrijkste stakeholder, Techtenna, was besloten om eerste een model voor de CO2 waarde te ontwikkelen. Wanneer dit succesvol is bevonden kan dit worden uitgebreid naar de overige meetwaarden.</p>
<h3 id="gegevensverzameling">Gegevensverzameling</h3>
<p>Tijdens de tweede oplevering van het project werd door Marco van Techtenna opgemerkt dat het aantal personen wat zich in een ruimte bevindt invloed heeft op de CO2 niveaus. Via de Google Calendar API is opgevraagd hoeveel personen zich op een bepaalde tijd in een ruimte bevinden. Deze gegevens zijn toegevoegd aan de dataset zoals beschreven in de vorige iteratie.</p>
<p>Uit een vergelijkbaar onderzoek<sup id="fnref:7"><a class="footnote-ref" href="#fn:7">7</a></sup> is gebleken dat temperatuur, luchtvochtigheid en activiteitsniveau een mogelijke invloed kunnen hebben op de CO2 waarde. Door deze waarden te visualiseren in een correlatie heatmap kon dit gevalideerd worden.</p>
<p><center>
<img alt="Correlatie heatmap" src="../images/realisatie/heatmap.png" />
</center>
<center><small>Afbeelding 7: Correlatie Heatmap</small></center></p>
<h3 id="beschrijving-resultaten_1">Beschrijving &amp; resultaten</h3>
<p>Om het tweede doel te behalen zijn er twee modellen uitgewerkt. Een voor lange termijn voorspellingen en een voor korte termijn voorspellingen. In het onderzoeksrapport<sup id="fnref:8"><a class="footnote-ref" href="#fn:8">8</a></sup> wordt verder toegelicht welke data gebruikt was en hoe deze werd voorbereid.</p>
<p><strong>Korte termijn - Modellen</strong> <br>
Tijdens het onderzoek van Kallio et al.<sup id="fnref2:7"><a class="footnote-ref" href="#fn:7">7</a></sup> worden meerdere mogelijke modellen beschreven. Deze zijn specifiek uitgekozen omdat ze accurate voorspellingen kunnen geven op auto gecorreleerde data.</p>
<ul>
<li><a href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.Ridge.html">Ridge Regression (RR)</a></li>
<li><a href="https://scikit-learn.org/stable/modules/generated/sklearn.tree.DecisionTreeRegressor.html">Decision Tree (DT)</a></li>
<li><a href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestRegressor.html">Random Forest (RF)</a></li>
<li><a href="https://scikit-learn.org/stable/modules/generated/sklearn.neural_network.MLPRegressor.html">Multilayer Perceptron (MLP)</a></li>
</ul>
<p>Aangezien de CO2 waarden in een ruimte vaak niet drastisch veranderen in korte tijd is er gekozen om als baseline een ‘last-observation carried forward’ model te gebruiken. Dit geeft een de laatst gemeten CO2 waarde aan als de voorspelde waarde.</p>
<p><strong>Korte termijn - Features</strong> <br>
Per model kan het verschillen welke features tot het beste resultaat leiden. Om dit te optimaliseren is gebruik gemaakt van de <code>SelectKBest</code> class. Deze klasse maakt gebruik van <code>f_regression</code> om te bepalen welke features het meest gecorreleerd zijn tot het target. Tussen de drie en dertig features zijn getest door middel van GridSearch. Onderstaand valt per model te zien welke features de hoogste score behalen.</p>
<p><img alt="Feature selectie" src="../images/realisatie/feature-selection.png" /></p>
<p><center><small>Afbeelding 8: Feature selectie</small></center></p>
<p>Een belangrijke bevinding uit deze grafiek is dat de modellen niet alleen de voorgaande CO2 metingen gebruiken, wat overfitting zou veroorzaken, maar ook bijvoorbeeld verlichting- en luchtvochtigheidsniveaus.</p>
<p><strong>Korte termijn - Resultaten</strong> <br>
Door de voorspelde waarde tegenover daadwerkelijke waarde te plotten kunnen patronen in de fouten van model worden opgespoord. Ideaal gezien vormen deze plotten een diagonale lijn, zoals bij het baseline, RR en MLP model. Dit betekend dat de voorspelde waarde dicht bij de daadwerkelijke waarde ligt. Bij de DTR en RF modellen worden de voorspellingen onnauwkeurig wanneer ze hoger worden.
<center>
<img alt="Daadwerkelijk vs. voorspelt" src="../images/realisatie/actual-v-predicted.png" />
</center>
<center><small>Afbeelding 9: Daadwerkelijk vs. voorspelt</small></center></p>
<p>De r-squared (R2) score van een model geeft aan hoe goed de fit is van een model. Hoe dichter dit bij 1.0 is hoe beter. Het MLP en RR model presteren beter dan de baseline. Dit valt ook te zien in de foutmarges van de modellen. Het RR model presteert het beste op RMSE en MAE
<center>
<img alt="Model evaluatie" src="../images/realisatie/model-eval.png" />
</center>
<center><small>Afbeelding 10: Model evaluatie</small></center></p>
<p><strong>Lange termijn - Resultaten</strong> </br></p>
<p>Ieder model, baseline inbegrepen, vertoont hetzelfde patroon. Er zitten meer lage waarden in de dataset dan hoge. Hierdoor zijn alle modellen gebiased richting lagere voorspellingen.
<img alt="Daadwerkelijk vs. voorspelt" src="../images/realisatie/long-term-actual-v-predicted.png" /></p>
<p><center><small>Afbeelding 9: Daadwerkelijk vs. voorspelt</small></center></p>
<h3 id="bevindingen_1">Bevindingen</h3>
<p>Vanuit de vorige iteratie waren er een viertal uitdagingen die opgelost moesten worden. Onderstaand zijn deze, en de oplossingen, toegelicht.</p>
<p><em>Onderzoeken wat invloed heeft op veranderingen in de meetwaarden en deze data toevoegen aan de modellen.</em></p>
<p>CO2 gehaltes worden vooral bepaald door het aantal personen in een ruimte. Door gebruik te maken van de google calendar API kan opgevraagd worden hoeveel personen zich op een bepaalde tijd in de ruimte bevonden.</p>
<p><em>Verder in de toekomst kijken, 3 uur of meer.</em></p>
<p>In het onderzoek van Kallio et al. <sup id="fnref3:7"><a class="footnote-ref" href="#fn:7">7</a></sup> werd geconcludeerd dat voorspellingen voor de lange termijn vaak niet accuraat zijn. Hierdoor is er gekozen om een model te ontwikkelen wat op korte termijn accuraat is, deze zal ondersteunt worden door een visualisatie van gemiddelde voor een bepaalde dag en tijd.</p>
<p><em>Betere controleren voor welk tijdstip de voorspelling gemaakt worden.</em></p>
<p>Door andere data voorbereidingstechnieken te gebruiken wordt er geen voorspelling gedaan voor een bepaald tijdstip. Hierdoor hoeft deze ook niet meer gecontroleerd te worden.</p>
<p><em>Bestandsgrootte modellen verminderen om schaalbaarheid te vergroten.</em></p>
<p>De Ridge Regression modellen zijn minder dan 64 KB groot. Dit betekend dat het makkelijk schaalbaar is wanneer ze voor digital twins met veel ruimten moeten worden gebruikt</p>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p><a href="../pdfs/model_experimenten_v1.pdf#page=3">Model experimenten rapport - versie 1: Gegevensoverzicht</a> <em>blz. 3 t/m 9</em>&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:2">
<p><a href="../pdfs/model_experimenten_v1.pdf#page=21">Model experimenten rapport - versie 1: Bronnen</a> <em>blz. 21</em>&#160;<a class="footnote-backref" href="#fnref:2" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="fn:3">
<p><a href="../pdfs/model_experimenten_v1.pdf#page=13">Model experimenten rapport - versie 1: Gegevensvoorbereiding</a> <em>blz. 12</em>&#160;<a class="footnote-backref" href="#fnref:3" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
<li id="fn:4">
<p><a href="https://stackoverflow.blog/2020/10/12/how-to-put-machine-learning-models-into-production/">StackoverFlow Blog: How to put machine learning models into production</a>&#160;<a class="footnote-backref" href="#fnref:4" title="Jump back to footnote 4 in the text">&#8617;</a></p>
</li>
<li id="fn:5">
<p><a href="https://c4model.com/">c4model.com</a>&#160;<a class="footnote-backref" href="#fnref:5" title="Jump back to footnote 5 in the text">&#8617;</a></p>
</li>
<li id="fn:6">
<p><a href="../pdfs/ontwerp.pdf#page=4">Ontwerpdocument: Vooronderzoek</a> <em>blz. 3 t/m 6</em>&#160;<a class="footnote-backref" href="#fnref:6" title="Jump back to footnote 6 in the text">&#8617;</a></p>
</li>
<li id="fn:7">
<p><a href="https://doi.org/10.1016/j.buildenv.2020.107409">Forecasting office indoor CO2 concentration using machine learning with a one-year dataset</a>&#160;<a class="footnote-backref" href="#fnref:7" title="Jump back to footnote 7 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:7" title="Jump back to footnote 7 in the text">&#8617;</a><a class="footnote-backref" href="#fnref3:7" title="Jump back to footnote 7 in the text">&#8617;</a></p>
</li>
<li id="fn:8">
<p><a href="../pdfs/model_experimenten_v2.pdf#page=6">Model experimenten rapport - versie 2: Model beschrijvingen</a><em>blz. 5 t/m 6</em>&#160;<a class="footnote-backref" href="#fnref:8" title="Jump back to footnote 8 in the text">&#8617;</a></p>
</li>
</ol>
</div>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../analyseren/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Analyseren
            </div>
          </div>
        </a>
      
      
        <a href="../realiseren/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Realiseren
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../assets/javascripts/workers/search.fe42c31b.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.4ea5477f.min.js"></script>
      
    
  </body>
</html>